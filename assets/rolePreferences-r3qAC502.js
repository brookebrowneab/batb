import{d as n}from"./index-DAsUYhLQ.js";async function _(){const{data:e,error:t}=await n.from("audition_settings").select("*").limit(1).maybeSingle();return{data:e,error:t}}async function c(e,t){const{data:a}=await n.from("audition_settings").select("id").limit(1).maybeSingle();if(!a){const{data:s,error:o}=await n.from("audition_settings").insert({...e,updated_by_staff_user_id:t}).select().single();return{data:s,error:o}}const{data:r,error:i}=await n.from("audition_settings").update({...e,updated_by_staff_user_id:t,updated_at:new Date().toISOString()}).eq("id",a.id).select().single();return{data:r,error:i}}async function u(){const{data:e,error:t}=await n.from("audition_roles").select("*").order("display_order",{ascending:!0}).order("name",{ascending:!0});return{data:e||[],error:t}}async function l(){const{data:e,error:t}=await n.from("vocal_role_day_mappings").select("*");return{data:e||[],error:t}}async function f(e,t,a){const{data:r,error:i}=await n.from("vocal_role_day_mappings").upsert({audition_role_id:e,audition_date:t,created_by_staff_user_id:a,updated_by_staff_user_id:a,updated_at:new Date().toISOString()},{onConflict:"audition_role_id"}).select().single();return{data:r,error:i}}async function p(e){const{error:t}=await n.from("vocal_role_day_mappings").delete().eq("audition_role_id",e);return{error:t}}async function m(e,t,a){const{data:r,error:i}=await n.from("audition_roles").insert({name:e,display_order:t,created_by_staff_user_id:a,updated_by_staff_user_id:a}).select().single();return{data:r,error:i}}async function g(e,t,a){const{data:r,error:i}=await n.from("audition_roles").update({...t,updated_by_staff_user_id:a,updated_at:new Date().toISOString()}).eq("id",e).select().single();return{data:r,error:i}}async function y(e){const{error:t}=await n.from("audition_roles").delete().eq("id",e);return{error:t}}async function w(e){const{data:t,error:a}=await n.from("student_role_preferences").select("*, audition_roles(id, name)").eq("student_id",e).order("rank_order",{ascending:!0});return{data:t||[],error:a}}async function b(e,t,a){const{error:r}=await n.from("student_role_preferences").delete().eq("student_id",e);if(r)return{error:r};if(t.length===0)return{error:null};const i=t.map(o=>({student_id:e,audition_role_id:o.roleId,rank_order:o.rank,created_by_user_id:a,updated_by_user_id:a})),{error:s}=await n.from("student_role_preferences").insert(i);return{error:s}}async function S(){const{data:e,error:t}=await n.from("students").select(`
      id, first_name, last_name, grade, parent_email, parent_first_name,
      registration_complete, callback_invited,
      parent2_email, parent2_first_name, student_email, sings_own_disney_song, song_name,
      student_role_preferences(id, audition_role_id, rank_order, audition_roles(id, name))
    `).eq("registration_complete",!0).order("last_name",{ascending:!0});return{data:(e||[]).map(r=>({...r,role_preferences:r.student_role_preferences||[]})),error:t}}async function h(){const{data:e,error:t}=await n.from("vocal_day_assignments").select("*, students(id, first_name, last_name, grade, parent_email, parent_first_name, parent2_email, parent2_first_name, student_email, sings_own_disney_song, song_name)").order("audition_date",{ascending:!0});return{data:e||[],error:t}}async function D(e,t){const{data:a,error:r}=await n.rpc("assign_vocal_day",{p_student_id:e,p_audition_date:t});return{data:a,error:r}}async function A(e){const{data:t,error:a}=await n.rpc("unassign_vocal_day",{p_student_id:e});return{data:t,error:a}}async function R(e){const{data:t,error:a}=await n.from("vocal_day_assignments").select("*").eq("student_id",e).maybeSingle();return{data:t,error:a}}async function q(e,t,a,r){const{data:i,error:s}=await n.rpc("log_notification_send",{p_student_id:e,p_recipient_email:t,p_subject:a,p_body_preview:r});return{data:i,error:s}}async function v(){const{data:e,error:t}=await n.from("registration_email_templates").select("*").eq("template_key","registration_schedule").maybeSingle();return{data:e,error:t}}async function k(e,t){const a={template_key:"registration_schedule",...e,updated_by_staff_user_id:t,updated_at:new Date().toISOString()},{data:r,error:i}=await n.from("registration_email_templates").upsert(a,{onConflict:"template_key"}).select().single();return{data:r,error:i}}export{R as a,u as b,w as c,h as d,D as e,_ as f,v as g,y as h,k as i,g as j,m as k,l,S as m,f as n,p as o,A as p,q,b as s,c as u};
